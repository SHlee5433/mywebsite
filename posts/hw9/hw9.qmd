---
title: "LS λΉ…λ°μ΄ν„° μ¤μΏ¨ Homework 9"
author: "μΉν•™"
date: "2024-09-10"
categories: [bigdata]

---
## λ¬Έμ 

**μΆ…μ†λ³€μ: λ°±νλ³‘ μ„Έν¬ κ΄€μΈ΅ λ¶κ°€ μ—¬λ¶€ (REMISS), 1μ΄λ©΄ κ΄€μΈ΅ μ•λ¨μ„ μλ―Έ**

**λ…λ¦½λ³€μ:**
**κ³¨μμ μ„Έν¬μ„± (CELL)**<br>
**κ³¨μνΈμ λ°±νκµ¬ λΉ„μ¨ (SMEAR)**<br>
**κ³¨μμ λ°±νλ³‘ μ„Έν¬ μΉ¨ν¬ λΉ„μ¨ (INFIL)**<br>
**κ³¨μ λ°±νλ³‘ μ„Έν¬μ λΌλ²¨λ§ μΈλ±μ¤ (LI)**<br>
**λ§μ΄νμ•΅μ λ°±νλ³‘ μ„Έν¬ μ (BLAST)**<br>
**μΉλ£ μ‹μ‘ μ „ μµκ³  μ²΄μ¨ (TEMP)**

## Q1.
**λ°μ΄ν„°λ¥Ό λ΅λ“ν•κ³ , λ΅μ§€μ¤ν‹± νκ·€λ¨λΈμ„ μ ν•©ν•κ³ , νκ·€ ν‘λ¥Ό μ‘μ„±ν•μ„Έμ”**
```{python}

# μ›ν‚Ή λ””λ ‰ν† λ¦¬ ν™•μΈν•κΈ°
import pandas as pd
import statsmodels.api as sm
import os
cwd = os.getcwd()
cwd

# λ°μ΄ν„° λ΅λ“ν•κΈ°
df = pd.read_table('./data/leukemia_remission.txt',delim_whitespace=True)

df

# λ΅μ§€μ¤ν‹± νκ·€λ¨λΈ μ ν•© ν›„, νκ·€ ν‘ μ‘μ„±

model = sm.formula.logit("REMISS ~ CELL + SMEAR + INFIL + LI + BLAST + TEMP", data = df).fit()

print(model.summary())

```

## Q2.
**ν•΄λ‹Ή λ¨λΈμ€ ν†µκ³„μ μΌλ΅ μ μν•κ°€μ”? κ·Έ μ΄μ λ¥Ό κ²€μ •ν†µκ³„λ‰λ¥Ό μ‚¬μ©ν•΄μ„ μ„¤λ…ν•μ‹μ¤.**

```{python}

from scipy.stats import chi2
# κ²€μ •ν†µκ³„λ‰ : β’2(β„“(π›½)Μ‚ (0) β’ β„“(π›½)Μ‚ )  =  -2*(-17.186+10.797)  = 12.779
1 - chi2.cdf(12.779, df=6)  # 0.0467

# κ²°λ΅  : LLR p-value: 0.0467 < μ μμμ¤€ 0.05λ³΄λ‹¤ μ‘μΌλ‹κΉ ν†µκ³„μ μΌλ΅ μ μν•λ‹¤κ³  ν•  μ μλ‹¤.

```

## Q3.
**μ μμμ¤€ 0.2λ¥Ό κΈ°μ¤€μΌλ΅ ν†µκ³„μ μΌλ΅ μ μν• λ³€μ**

```{python}

# p-valueκ°€ 0.2λ³΄λ‹¤ μ‘μ€ λ³€μ = LI, TEMP

```

## Q4.
**λ‹¤μ ν™μμ— λ€ν• μ¤μ¦λ” μ–Όλ§μΈκ°€μ”?**<br>
**CELL (κ³¨μμ μ„Έν¬μ„±): 65%**<br>
**SMEAR (κ³¨μνΈμ λ°±νκµ¬ λΉ„μ¨): 45%**<br>
**INFIL (κ³¨μμ λ°±νλ³‘ μ„Έν¬ μΉ¨ν¬ λΉ„μ¨): 55%**<br>
**LI (κ³¨μ λ°±νλ³‘ μ„Έν¬μ λΌλ²¨λ§ μΈλ±μ¤): 1.2**<br>
**BLAST (λ§μ΄νμ•΅μ λ°±νλ³‘ μ„Έν¬ μ): 1.1μ„Έν¬/ΞΌL**<br>
**TEMP (μΉλ£ μ‹μ‘ μ „ μµκ³  μ²΄μ¨): 0.9**

```{python}
import numpy as np

odds = np.exp(64.258 + 30.830 * 0.65 + 24.686 * 0.45 + (-24.975) * 0.55 + 4.361 * 1.2 + (-0.012) * 1.1 + (-100.173) * 0.9)

odds  # 0.038

```

## Q5. 
**μ„ ν™μμ νμ•΅μ—μ„ λ°±νλ³‘ μ„Έν¬κ°€ κ΄€μΈ΅λμ§€ μ•μ€ ν™•λ¥ μ€ μ–Όλ§μΈκ°€μ”?**

```{python}

odds / (1 + odds) # 0.037

```

## Q6. 
**TEMP λ³€μμ κ³„μλ” μ–Όλ§μ΄λ©°, ν•΄λ‹Ή κ³„μλ¥Ό μ‚¬μ©ν•΄μ„ TEMP λ³€μκ°€ λ°±νλ³‘ μΉλ£μ— λ€ν• μν–¥μ„ μ„¤λ…ν•μ‹μ¤.**

```{python}

# TEMP λ³€μμ κ³„μ = -100.173
# μ¤μ¦λΉ„ 3.127
# TEMPκ°€ 1 μ¬λΌκ°€λ©΄ λ΅κ·Έ μ¤μ¦λ” 157.86λ§νΌ κ°μ†ν•λ©°, λ°±νλ³‘ μƒνƒμ— λ„λ‹¬ν•  κ°€λ¥μ„±μ΄ ν¬κ² μ¤„μ–΄λ“ λ‹¤

np.exp(-100.173)

```

## Q7. 
**CELL λ³€μμ 99% μ¤μ¦λΉ„μ— λ€ν• μ‹ λΆ°κµ¬κ°„μ„ κµ¬ν•μ‹μ¤.**

```{python}

cell_beta = 30.830
z = 2.58
std_err = 52.135

upper = cell_beta + z * std_err
lower = cell_beta - z * std_err

# CELL λ³€μ κ³„μμ μ‹ λΆ°κµ¬κ°„
upper # 165.34
lower # -103.68

# CELL λ³€μ μ¤μ¦λΉ„μ— λ€ν• μ‹ λΆ°κµ¬κ°„

np.exp(upper), np.exp(lower) 
```

## Q8. 
**μ£Όμ–΄μ§„ λ°μ΄ν„°μ— λ€ν•μ—¬ λ΅μ§€μ¤ν‹± νκ·€ λ¨λΈμ μμΈ΅ ν™•λ¥ μ„ κµ¬ν• ν›„, 50% μ΄μƒμΈ κ²½μ° 1λ΅ μ²λ¦¬ν•μ—¬, νΌλ™ ν–‰λ ¬λ¥Ό κµ¬ν•μ‹μ¤.**

```{python}

from sklearn.metrics import confusion_matrix

# 1. λ¨λΈμ„ μ‚¬μ©ν•μ—¬ μμΈ΅ ν™•λ¥ μ„ κ³„μ‚°
pred_probs = model.predict(df)

# 2. 50% κΈ°μ¤€μΌλ΅ μ΄μ§„ν™” (0 λλ” 1λ΅ λ³€ν™)
predictions = [1 if prob > 0.5 else 0 for prob in pred_probs]

# 3. μ‹¤μ  κ°’ (df['REMISS'])κ³Ό μμΈ΅ κ°’ (predictions) λΉ„κµν•μ—¬ νΌλ™ ν–‰λ ¬ κ³„μ‚°
conf_matrix = confusion_matrix(df['REMISS'], predictions)

# νΌλ™ ν–‰λ ¬ μ¶λ ¥
conf_matrix

```

## Q9. 
**ν•΄λ‹Ή λ¨λΈμ Accuracyλ” μ–Όλ§μΈκ°€μ”?**
```{python}

# Accuracy = μ „μ²΄ μμΈ΅μ—μ„ μ³μ€ μμΈ΅μ λΉ„μ¨

Accuracy = (15 + 5) / (15 + 3 + 4 + 5)
Accuracy # 0.741

```

## Q10. 
**ν•΄λ‹Ή λ¨λΈμ F1 Scoreλ¥Ό κµ¬ν•μ„Έμ”.**
```{python}

pre = 5 / (5 + 3)
re = 5 / (5 + 4)

F1 = 2 * (pre * re) / (pre + re)
F1 # 0.588

```
